# Assignment 2: 

The goal of this homework is to ...

## Script description

#### join_map.py
Reads data from two tables (trips and fares) one line at a time. For each line, regardless of the table it comes from, the following key-value pair is generated and printed:

key := medallion,starttime
value := line

#### join_reduce.py
Reads the key-value pairs generated by *join_map.py*, also in a streaming fashion, and joins the lines corresponding to the same trip. This script also takes care of getting rid of corrupt data, specifically trips that have:
* A trip distance smaller than 0.05 miles
* A trip distance larger than 70 miles
* A pickup longitude or langitude of 0
* A dropoff longitude or langitude of 0
* A payment of $0
* A total fare of $0
* A trip duration larger than 4 hours or smaller than 15 seconds

#### driver_stats_map.py
Reads the joined trip data table (output of *join_reduce.py*) and, for each trip, emits the required number of key-value pairs of the following structure:

key := pickup date, pickup hour, hack
value := pickup time and date, dropoff time and date, n_passengers, n_miles, earnings

Where the pickup and dropoff time are in the same hour. If a trip spans over two hours (for example from 2:45 until 3:10), two lines will be emitted (from 2:45 to 2:59 and from 3:00 to 3:10).

#### driver_stats_reduce.py
Reads the key-value pairs generated by *driver_stats_map.py* and computes the following metrics:
* t_onduty: the total amount of time that the driver was on duty during the hour. For example, 0.25 means the driver was on duty for 15 minutes that hour.
* t_occupied: the total amount of time with passengers in the cab during the hour, again in units of hours, as above.
* n_pass: the total number of passengers picked up during the hour.
* n_trip: the total number of trips started during the hour.
* n_mile: the total number of miles traveled with passengers in the hour. For trips that cross an hour boundary, it is assumed the driver traveled at a constant speed for the duration of the trip.
* earnings: the total amount of money the driver earned in that hour. As with mileage, for trips that cross an hour boundary, it is assumed that drivers earn the final payment at a constant rate throughout the trip. Earnings consist of the fare plus the tip. 

#### aggregate_map.py
Reads the table with the computed metrics (generated by *driver_stats_reduce.py*) and generates the following key-value pairs:

key:= data,hour
value:= t_onduty,t_occupied,n_pass,n_trip,n_mile,earnings

#### aggregate_reduce.py
Reads the key-value pairs generated by *aggregate_map.py* and aggregates the quantities by date and hour.
The schema of the output is: date, hour, drivers_onduty, t_onduty, t_occupied, n_pass, n_trip, n_mile, earnings
where drivers_onduty is the number of drivers who were on duty for at least one minute during the hour, and the remaining quantities are the sums.
